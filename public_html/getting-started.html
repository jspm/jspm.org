<!DOCTYPE html><html data-theme="light" lang="en"><head><link rel="alternate" title="JSPM" type="application/json" href="https://jspm.org/feed.json"><meta property="og:title" content="JSPM - Getting Started"><meta property="og:image" content="https://jspm.org/jspm.png"><meta name="Description" content="JSPM Getting Started"><meta property="og:description" content="JSPM Getting Started"><meta property="og:url" content="https://jspm.org/getting-started"><meta name="twitter:card" content="summary_large_image"><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style.css?v1">
<link rel="preload" as="font" href="/sourcesans-light.woff2" type="font/woff2" crossorigin="anonymous">
<script defer="" src="/script.js?v1"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-40327700-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-40327700-2');
</script>
<title>JSPM - Getting Started</title></head><body class="page-getting-started">
<div class="topbar">
  <a style="display: block" href="/">
    <div class="logobox" href="/"></div>
    <h1 class="logo">jspm</h1>
  </a>
  <ul class="toplinks">
    <li><a target="_blank" href="https://generator.jspm.io" rel="noopener">Online Generator</a></li>
    <li><a target="_blank" href="https://status.jspm.io" rel="noopener">CDN Status</a></li>
    <li><a target="_blank" href="https://opencollective.com/jspm" rel="noopener">Sponsor</a></li>
    <li class="github"><a target="_blank" href="https://github.com/jspm/jspm" rel="noopener"></a></li>
  </ul>
  <div class="mobile-menu"></div>
</div>
<div class="sidebar">
  <div class="toc">
    <ul class="sections">
      <li>
        <a href="/getting-started">JSPM</a>
        <ul class="section">
          <li><a href="/getting-started">Getting Started</a></li>
          <li><a href="/faq">FAQ</a></li>
        </ul>
      </li>

      <li>
        <a href="/docs/jspm-cli">Documentation</a>
        <ul class="section">
          <li><a href="/docs/jspm-cli">JSPM CLI</a></li>
          <li><a href="/docs/generator">JSPM Generator</a></li>
          <li><a href="/docs/integrations">Integrations</a></li>
          <li><a href="/docs/cdn-resolution">CDN Resolution</a></li>
        </ul>
      </li>

      <li>
        <a href="/cdn/jspm-io">CDN</a>
        <ul class="section">
          <li><a href="/cdn/jspm-io">jspm.io</a></li>
          <li><a href="/cdn/jspm-dev">jspm.dev</a></li>
          <li><a href="/cdn/api">API</a></li>
        </ul>
      </li>

      <li class="blog">
        <a href="/jspm-cli">Blog</a>
        <ul class="section">
          <li class="blog-link"><a href="/jspm-cli"><em>JSPM CLI Relaunch<span class="date">04/04/23</span></em></a></li>
          <li class="blog-link"><a href="/import-map-cdn"><em>Import Map CDN Launch<span class="date">02/03/21</span></em></a></li>
        </ul>
      </li>
    </ul>
    <!-- <div class="footer"></div> -->
  </div>
</div>
<div class="content-container">
  <div class="content"><h1>Getting Started</h1>
<p>This guide runs through the steps of setting up the JSPM CLI and using it in some standard import maps workflows from development to production.</p>
<p>If you just want to get a quick feel for import maps, <a href="#online-generator">skip to the online generator guide</a>.</p>
<p>For Deno import map workflows, see the <a href="#deno-workflows">Deno workflows</a> section.</p>
<a name="installation" class="anchor main"></a><h2>Installation</h2>
<p>Ensure you have <a href="https://nodejs.org/en" target="_blank" rel="noopener">Node.js</a> installed.</p>
<p>From the command-line, the JSPM CLI can then be installed using npm:</p>
<pre><code>npm install -g jspm
</code></pre>
<a name="its-just-linking" class="anchor main"></a><h2>It's Just Linking</h2>
<p>With JSPM installed, let's create an import map.</p>
<p>All browsers require import maps to be inlined into the HTML file that is being provided to the browser.</p>
<p>Create a <code>lit.html</code> file:</p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;script type=<span class="string">"module"</span>&gt;
  <span class="keyword">import</span> * <span class="keyword">as</span> lit <span class="keyword">from</span> <span class="string">'lit'</span>;
  console.log(lit);
&lt;/script&gt;
</code></pre>
<p>Now we can use JSPM to <em>link</em> this HTML file and create the import map necessary for it to work correctly:</p>
<pre><code>jspm link lit.html -o lit.html
</code></pre>
<p>The above tells JSPM to trace the modules inside of <code>lit.html</code> and generate the import map for them, then injecting the import map output back into <code>lit.html</code>.</p>
<p>This will update <code>lit.html</code> to contain the following:</p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;script <span class="keyword">async</span> src=<span class="string">"https://ga.jspm.io/npm:es-module-shims@<span class="number">1</span>.<span class="number">7</span>.<span class="number">1</span>/dist/es-module-shims.js"</span> crossorigin=<span class="string">"anonymous"</span>&gt;&lt;/script&gt;
&lt;script type=<span class="string">"importmap"</span>&gt;
{
  <span class="string">"imports"</span>: {
    <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
&lt;/script&gt;
&lt;script type=<span class="string">"module"</span>&gt;
  <span class="keyword">import</span> * <span class="keyword">as</span> lit <span class="keyword">from</span> <span class="string">'lit'</span>;
  console.log(lit);
&lt;/script&gt;
</code></pre>
<p>JSPM has traced out all the dependencies necessary for an import of <code><span class="keyword">import</span> <span class="string">'lit'</span></code> to work correctly, and provided the versioned resolutions of those dependencies against the production-optimized <a href="/cdn/jspm-io">jspm.io module CDN</a>. It has also included <a href="https://github.com/guybedford/es-module-shims" target="_blank" rel="noopener">ES Module Shims</a> to polyfill import maps in browsers without support for import maps.</p>
<p>Run a local server to view the application (disabling local caching to enable development refreshing):</p>
<pre><code>npx http-server -c-1
</code></pre>
<blockquote>
<p>For server-side HTML generation, the import map should be created ahead of time as JSON, which is inlined by the server. Note that JSPM HTML injection uses a very lenient HTML parser that should support templating languages just fine. JSON import map output for JSPM is the default when not specifying a different output via the <code>-o</code> option.</p>
</blockquote>
<a name="linking-local-application-code" class="anchor main"></a><h2>Linking Local Application Code</h2>
<p>Instead of using inline modules, we can link local modules directly, changing the inline <code>lit</code> import to a local application path instead:</p>
<p><em>app.html</em></p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;script type=<span class="string">"module"</span>&gt;<span class="keyword">import</span> <span class="string">'./src/app.js'</span>&lt;/script&gt;
</code></pre>
<p>Where <code>src/app.js</code> contains local application:</p>
<p><em>src/app.js</em></p>
<pre><code class="language-js"><span class="keyword">import</span> * <span class="keyword">as</span> lit <span class="keyword">from</span> <span class="string">'lit'</span>;

console.log(lit);
</code></pre>
<p>Now we can link the application code directly instead to inject into <code>app.html</code>:</p>
<pre><code>jspm link src/app.js -o app.html
</code></pre>
<p>The generated <code>app.html</code> now includes both our local code mapping as well as the lit mapping:</p>
<blockquote>
<p>When using TypeScript or JSX workflows, it is advisable to have a compilation step that compiles these files from <code>src/[file].ts</code> into corresponding direct <code>lib/[file].js</code> output file, individually, eg via the normal <code>tsc</code> invocation in TypeScript or when using a tool like <code>swc</code> for JSX. <a href="https://chompbuild.com" target="_blank" rel="noopener">Chomp</a> is another task runner that is based around this <a href="https://github.com/guybedford/chomp#example-typescript-with-swc" target="_blank" rel="noopener">per-file compilation pattern</a>. See the <a href="#production-workflow">production workflow</a> at the end of this guide for handling local code optimization.</p>
</blockquote>
<a name="package-management-with-import-maps" class="anchor main"></a><h2>Package Management with Import Maps</h2>
<p>So how does package management fit in with this? Well, the import maps that we have been generating all involve versioned solutions for dependency graphs that we are linking in. The import map itself behaves like a lock file.</p>
<p>Instead of just linking and generating the lock file each time, we can instead be a bit more deliberate about import map packagement with JSPM.</p>
<a name="defining-dependency-ranges" class="anchor"></a><h3>Defining Dependency Ranges</h3>
<p>Unless otherwise specified, JSPM uses the <code>package.json</code> for dependency ranges for both local and remote packages, just like Node.js (and other runtimes).</p>
<p><em>package.json</em></p>
<pre><code class="language-json">{
  <span class="string">"type"</span>: <span class="string">"module"</span>,
  <span class="string">"dependencies"</span>: {
    <span class="string">"lit"</span>: <span class="string">"^<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>"</span>
  }
}
</code></pre>
<p>Instead of linking from scratch every single time, we can perfom a top-level install operation for lit. In larger projects there are likely multiple pages with different dependencies, while we want the main versioning and package management to dedupe versions between all of those.</p>
<a name="installing-packages" class="anchor"></a><h3>Installing Packages</h3>
<p>To install and lock package versions and resolutions ahead of time, use <code>jspm install</code>:</p>
<pre><code>jspm install lit lit/html.js
</code></pre>
<p>This populates a local <code>importmap.json</code> file with the locked import map resolutions for both <code>lit</code> and <code>lit/html.js</code>:</p>
<p><em>importmap.json</em></p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"development"</span>,
    <span class="string">"module"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>,
    <span class="string">"lit/html.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/html.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
</code></pre>
<a name="defining-custom-mappings" class="anchor"></a><h3>Defining Custom Mappings</h3>
<p>Any edits we make to this local import map file are respected when performing the subsequent <code>link</code> operations.</p>
<p>In addition any URLs can be installed into the import map as well.</p>
<p>For example, say we want to load the local application as <code><span class="keyword">import</span> <span class="string">'app'</span></code>, we can set add this map entry using an aliased install:</p>
<pre><code>jspm install app=./src/app.js
</code></pre>
<p><em>importmap.json</em></p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"development"</span>,
    <span class="string">"module"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./src/app.js"</span>,
    <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>,
    <span class="string">"lit/html.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/html.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
</code></pre>
<p>Just like npm can install local folders, local module URLs can be installed directly in JSPM, and they can also point to fully remote module URLs with transitive dependency installs applying in all cases.</p>
<p>Now we can update the HTML file to load <code>app</code> directly instead of having to hard-code the path:</p>
<p><em>app.html</em></p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;script type=<span class="string">"module"</span>&gt;<span class="keyword">import</span> <span class="string">'app'</span>&lt;/script&gt;
</code></pre>
<a name="linking-from-importmapjson" class="anchor"></a><h3>Linking from importmap.json</h3>
<p>By default <code>importmap.json</code> is always consulted as the source of truth for the initial mappings in all operations.</p>
<p>So linking <code>app</code> directly into <code>app.html</code>, it will now already have the correct resolution from there:</p>
<pre><code>jspm link app -o app.html
</code></pre>
<p>The <code>importmap.json</code> mappings will be respected, but only those mappings actually needed by the linking operation will be injected.</p>
<p>This results in:</p>
<p><em>app.html</em></p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;script <span class="keyword">async</span> src=<span class="string">"https://ga.jspm.io/npm:es-module-shims@<span class="number">1</span>.<span class="number">7</span>.<span class="number">1</span>/dist/es-module-shims.js"</span> crossorigin=<span class="string">"anonymous"</span>&gt;&lt;/script&gt;
&lt;script type=<span class="string">"importmap"</span>&gt;
{
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./src/app.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"./"</span>: {
      <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>
    },
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
&lt;/script&gt;
&lt;script type=<span class="string">"module"</span>&gt;<span class="keyword">import</span> <span class="string">'app'</span>&lt;/script&gt;
</code></pre>
<blockquote>
<p>Notice that <code>lit/html.js</code> wasn't injected because <code>jspm link</code> only traces what is necessary to link the provided module list to the linking command.</p>
</blockquote>
<a name="conditional-environments" class="anchor main"></a><h2>Conditional Environments</h2>
<p>The <code><span class="string">"env"</span></code> field in <code>importmap.json</code> includes conditional environment that we have installed against. The default in this case being the <code><span class="string">"browser"</span></code>, <code><span class="string">"module"</span></code> <code><span class="string">"development"</span></code> environment.</p>
<p>To switch to using the production versions of the dependencies, we can perform an argumentless install to update the entire <code>importmap.json</code> file:</p>
<pre><code>jspm install --env=production
</code></pre>
<p>The import map is converted into production resolutions:</p>
<p><em>importmap.json</em></p>
<pre><code>{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"module"</span>,
    <span class="string">"production"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./src/app.js"</span>,
    <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>,
    <span class="string">"react"</span>: <span class="string">"https://ga.jspm.io/npm:react@<span class="number">18</span>.<span class="number">2</span>.<span class="number">0</span>/index.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/is-server.js"</span>
    }
  }
}
</code></pre>
<p>Notice how the <em>development</em> prefix is no longer present in the module paths. This allows packages to provide different implementations for development and production, and is a feature of <a href="https://nodejs.org/dist/latest-v19.x/docs/api/packages.html#conditional-exports" target="_blank" rel="noopener">Node.js conditional exports</a>.</p>
<blockquote>
<p>The <code><span class="string">"env"</span></code> field is not an import map standard, but is used internally by JSPM for the <code>importmap.json</code> file only, when working with JSON import maps in order to be able to consistently resolve them in the correct environment. Future versions may use a separate environment file.</p>
</blockquote>
<a name="changing-providers" class="anchor main"></a><h2>Changing Providers</h2>
<p>The benefits of using an ESM-native CDN like <code>jspm.io</code> is that dependencies are fully production optimized, and older packages that only support CommonJS are automatically converted by the CDN into ES modules to support browser usage.</p>
<p>Lit is actually a package that is designed from the start as an ESM package and it is also optimized at publish time, so it's actually possible to create an import map directly against the original sources.</p>
<a name="the-nodemodules-provider" class="anchor"></a><h3>The nodemodules Provider</h3>
<p>To achieve this locally, install the dependencies into node_modules with npm, as well as the <code>es-module-shims</code> polyfill itself:</p>
<pre><code>npm install lit es-module-shims
</code></pre>
<p>Now the <code>--provider</code> option will resolve all packages against the <code>nodemodules</code> provider with JSPM, just like the conditional environment change was handled previously:</p>
<pre><code>jspm install --provider nodemodules
</code></pre>
<p>If everything resolves correctly, the result is an <code>importmap.json</code> referencing the local <code>node_modules</code> folder:</p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"module"</span>,
    <span class="string">"production"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./src/app.js"</span>,
    <span class="string">"lit"</span>: <span class="string">"./node_modules/lit/index.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"./node_modules/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"./node_modules/@lit/reactive-element/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"./node_modules/lit-element/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"./node_modules/lit-html/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"./node_modules/lit-html/is-server.js"</span>
    }
  }
}
</code></pre>
<a name="using-other-cdn-providers" class="anchor"></a><h3>Using Other CDN Providers</h3>
<p>Alternatively, Lit can be loaded from another CDN like jsdelivr:</p>
<pre><code>jspm install --provider jsdelivr
</code></pre>
<p>Resulting in:</p>
<p><em>importmap.json</em></p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"module"</span>,
    <span class="string">"production"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./src/app.js"</span>,
    <span class="string">"lit"</span>: <span class="string">"https://unpkg.com/lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>,
    <span class="string">"react"</span>: <span class="string">"https://unpkg.com/react@<span class="number">18</span>.<span class="number">2</span>.<span class="number">0</span>/index.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://unpkg.com/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://unpkg.com/@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://unpkg.com/lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://unpkg.com/lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://unpkg.com/lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/is-server.js"</span>
    }
  }
}
</code></pre>
<p>Note all resolution features including version resolution and conditional exports still work against the UNPKG provider.</p>
<p>Switch back to the <a href="/cdn/jspm-io">jspm.io provider</a> with:</p>
<pre><code>jspm install --provider jspm.io
</code></pre>
<blockquote>
<p>By default JSPM supports <code>jspm.io</code>, <code>nodemodules</code>, <code>esm.sh</code>, <code>denoland</code>, <code>unpkg</code>, <code>skypack</code> and <code>jsdelivr</code> package providers, and custom providers can be configured programatically in the JSPM Generator core generation library as well.</p>
</blockquote>
<a name="production-workflow" class="anchor main"></a><h2>Production Workflow</h2>
<p>The package management workflows above result in a very low-overhead development process. Local modules can import from other local modules all in the browser, and dependencies are cached for very fast refreshing. It makes for a very simple browser development workflow using just native ES modules.</p>
<p>For small applications it can be fine to just ship unminified / unbundled sources. But for larger applications it is always necessary to implement a build step for production.</p>
<p>We already switched from development to production dependencies changing the <a href="#conditional-environments">conditional environment</a>, so we only need to perform the bundle step.</p>
<a name="bundling-with-esbuild" class="anchor"></a><h3>Bundling with esbuild</h3>
<p>To build <code>src/app.js</code> for production with esbuild, first install esbuild:</p>
<pre><code>npm install esbuild
</code></pre>
<p>Then run a build of the <code>src/app.js</code> module, while treating all bare specifier imports as externals:</p>
<pre><code>./node_modules/.bin/esbuild src/app.js --bundle --format=esm --external:* --outfile=dist/app.js
</code></pre>
<ul>
<li><code>--format=esm</code> tells esbuild to output an ES module file, so we are still using native browser modules</li>
<li><code>--external:*</code> ensures we externalize all bare specifiers</li>
</ul>
<p>Manually update <code>importmap.json</code> to reference <code>dist/app.js</code> instead of <code>src/app.js</code>:</p>
<p><em>importmap.json</em></p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"browser"</span>,
    <span class="string">"development"</span>,
    <span class="string">"module"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./dist/app.js"</span>,
    <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>,
    <span class="string">"lit/html.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/html.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
</code></pre>
<a name="preload-injection" class="anchor"></a><h3>Preload Injection</h3>
<p>Now, when performing the <code>app.html</code> import map HTML injection for production add the <code>--preload</code> flag to inject <code>modulepreload</code> tags for the application:</p>
<pre><code>jspm link app.html -o app.html --preload
</code></pre>
<p>This results in the HTML:</p>
<p><em>app.html</em></p>
<pre><code>&lt;!doctype html&gt;
&lt;script <span class="keyword">async</span> src=<span class="string">"https://ga.jspm.io/npm:es-module-shims@<span class="number">1</span>.<span class="number">7</span>.<span class="number">1</span>/dist/es-module-shims.js"</span> crossorigin=<span class="string">"anonymous"</span>&gt;&lt;/script&gt;
&lt;script type=<span class="string">"importmap"</span>&gt;
{
  <span class="string">"imports"</span>: {
    <span class="string">"app"</span>: <span class="string">"./dist/app.js"</span>
  },
  <span class="string">"scopes"</span>: {
    <span class="string">"./"</span>: {
      <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span>
    },
    <span class="string">"https://ga.jspm.io/"</span>: {
      <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span>,
      <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span>,
      <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span>,
      <span class="string">"lit-html/is-server.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span>
    }
  }
}
&lt;/script&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"./dist/app.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/css-tag.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/development/reactive-element.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/development/lit-element.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/is-server.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/development/lit-html.js"</span> /&gt;
&lt;link rel=<span class="string">"modulepreload"</span> href=<span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/index.js"</span> /&gt;
&lt;script type=<span class="string">"module"</span>&gt;<span class="keyword">import</span> <span class="string">'app'</span>&lt;/script&gt;
</code></pre>
<p>The full set of static preloads being included in the HTML means that there is no dependency waterfall roundtrip latency, and instead all dependencies can be immediately requested upfront by the browser. This completes the production workflow!</p>
<a name="local-conditions" class="anchor main"></a><h2>Local Conditions</h2>
<p>In the previous workflows it was necessary to manually maintain the <code>app</code> mapping, and update this mapping when moving from development to production.</p>
<p>It is actually also possible to automatically manage this mapping in JSPM using standard module resolution features in the <code>package.json</code> file, with the following configuration:</p>
<p><em>package.json</em></p>
<pre><code>{
  <span class="string">"name"</span>: <span class="string">"app"</span>,
  <span class="string">"exports"</span>: {
    <span class="string">"."</span>: {
      <span class="string">"development"</span>: <span class="string">"./src/app.js"</span>,
      <span class="string">"default"</span>: <span class="string">"./dist/app.js"</span>
    }
  }
}
</code></pre>
<p>Running:</p>
<pre><code>jspm install --env=development
</code></pre>
<p>will now update the <code>app</code> mapping in <code>importmap.json</code> from <code>dist/app.js</code> to <code>src/app.js</code>.</p>
<p>JSPM is able to automatically switch between production and development modes for both the local application and external package code.</p>
<blockquote>
<p>The above <code>package.json</code> <code><span class="string">"name"</span></code> definition may look like a JSPM-specific workflow trick, but this is actually a native modules feature of Node.js module resolution, and is supported by most JS tooling, called <a href="https://nodejs.org/dist/latest-v19.x/docs/api/packages.html#self-referencing-a-package-using-its-name" target="_blank" rel="noopener">package self-reference resolution</a>.</p>
</blockquote>
<a name="deno-workflows" class="anchor main"></a><h2>Deno Workflows</h2>
<p>JSPM can also be used as a package manager for Deno import maps.</p>
<p>In Deno, the default import map is contained in <code>deno.json</code> (instead of JSPM's default <code>importmap.json</code>).</p>
<p>When outputting a JSON file, JSPM will respect any existing properties in that JSON file, only overriding the <code><span class="string">"imports"</span></code>, <code><span class="string">"scopes"</span></code> and <code><span class="string">"env"</span></code> fields. In this way JSPM can install directly into <code>deno.json</code> files as a Deno package manager.</p>
<p>Therefore that is needed for Deno package management with JSPM is adding <code>-m deno.json</code> to all install operations. Setting <code>--env=deno,no-browser</code> is also recommended.</p>
<a name="installing-deno-packages" class="anchor"></a><h3>Installing Deno Packages</h3>
<p>Packages can be installed directly from Deno's standard library:</p>
<pre><code>jspm install deno:crypto -m deno.json --env=deno
</code></pre>
<p>Giving:</p>
<p><em>deno.json</em></p>
<pre><code class="language-json">{
  <span class="string">"env"</span>: [
    <span class="string">"deno"</span>,
    <span class="string">"development"</span>,
    <span class="string">"module"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"crypto"</span>: <span class="string">"https://deno.land/std@<span class="number">0</span>.<span class="number">182</span>.<span class="number">0</span>/crypto/mod.ts"</span>
  }
}
</code></pre>
<p>To import in Deno, write:</p>
<p><em>app.ts</em></p>
<pre><code class="language-ts"><span class="keyword">import</span> * <span class="keyword">as</span> crypto <span class="keyword">from</span> <span class="string">'crypto'</span>;

console.log(crypto);
</code></pre>
<p>When running, Deno will automatically use the import map from <code>deno.json</code>:</p>
<pre><code>deno run app.ts
</code></pre>
<a name="installing-from-denoland" class="anchor"></a><h3>Installing from Denoland</h3>
<p>Third-party Deno packages can be installed from the <code>denoland:</code> registry, also supported by JSPM.</p>
<pre><code>jspm install denoland:oak -m deno.json
</code></pre>
<p>Giving:</p>
<p><em>deno.json</em></p>
<pre><code>{
  <span class="string">"env"</span>: [
    <span class="string">"deno"</span>,
    <span class="string">"development"</span>,
    <span class="string">"module"</span>
  ],
  <span class="string">"imports"</span>: {
    <span class="string">"crypto"</span>: <span class="string">"https://deno.land/std@<span class="number">0</span>.<span class="number">182</span>.<span class="number">0</span>/crypto/mod.ts"</span>,
    <span class="string">"oak"</span>: <span class="string">"https://deno.land/x/oak@v12.<span class="number">1</span>.<span class="number">0</span>/mod.ts"</span>
  }
}
</code></pre>
<p>We can test the new package by updating <code>app.ts</code>:</p>
<p><em>app.ts</em></p>
<pre><code class="language-ts"><span class="keyword">import</span> * <span class="keyword">as</span> oak <span class="keyword">from</span> <span class="string">'oak'</span>;
console.log(oak);
</code></pre>
<pre><code>deno run app.ts
</code></pre>
<a name="online-generator" class="anchor main"></a><h2>Online Generator</h2>
<p>The easiest way to try out JSPM is to generate an import map using the online generator at <a href="https://generator.jspm.io" target="_blank" rel="noopener">https://generator.jspm.io</a>.</p>
<div style="text-align: center;">
<a href="https://generator.jspm.io" target="_blank" rel="noopener"><img style="width: 100%" src="/steps/online-0.png"></a>
</div>

<p>In the top-left corner enter an npm package name to add to the import map (<code>lit</code> in this example):</p>
<div style="text-align: center;">
<img src="/steps/online-1.png">
</div>

<p>Press <code>Return</code> to add the package to the map. Then add any other dependency entries. For example to add the <code>./html.js</code> subpath export of lit, add <code>lit/html.js</code>:</p>
<div style="text-align: center;">
<img src="/steps/online-2.png">
</div>

<p>Versions are supported in package names before the subpath and items can be removed or changed from the controls provided.</p>
<p>The final import map is shown on the right, and can be retrieved as an HTML page template or as direct JSON.</p>
<p>In <a href="https://generator.jspm.io/#U2NhYGBiDs0rySzJSU1hyMkscTDSM9IzQLD0M0pyc/SyigHzBUtSKgA" target="_blank" rel="noopener">this example</a> we get:</p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=<span class="string">"utf-8"</span>&gt;
  &lt;title&gt;Untitled&lt;/title&gt;
  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=<span class="number">1</span>"</span>&gt;
&lt;/head&gt;
&lt;body&gt;
  <span class="comment">&lt;!--
    JSPM Generator Import Map
    Edit URL: https://generator.jspm.io/#U<span class="number">2</span>NhYGBiDs0rySzJSU<span class="number">1</span>hyMkscTDSM<span class="number">9</span>IzQLD<span class="number">0</span>M<span class="number">0</span>pyc/SyigHzBUtSKgA
  --&gt;</span>
   &lt;script type=<span class="string">"importmap"</span>&gt;
  {
    <span class="string">"imports"</span>: {
      <span class="string">"lit"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span>/index.js"</span>,
      <span class="string">"lit/html.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit@<span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span>/html.js"</span>
    },
    <span class="string">"scopes"</span>: {
      <span class="string">"https://ga.jspm.io/"</span>: {
        <span class="string">"@lit/reactive-element"</span>: <span class="string">"https://ga.jspm.io/npm:@lit/reactive-element@<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>/reactive-element.js"</span>,
        <span class="string">"lit-element/lit-element.js"</span>: <span class="string">"https://ga.jspm.io/npm:lit-element@<span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span>/lit-element.js"</span>,
        <span class="string">"lit-html"</span>: <span class="string">"https://ga.jspm.io/npm:lit-html@<span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span>/lit-html.js"</span>
      }
    }
  }
  &lt;/script&gt;
  
  <span class="comment">&lt;!-- ES Module Shims: Import maps polyfill <span class="keyword">for</span> modules browsers without <span class="keyword">import</span> maps support (Safari <span class="number">16</span>.<span class="number">3</span>) --&gt;</span>
  &lt;script <span class="keyword">async</span> src=<span class="string">"https://ga.jspm.io/npm:es-module-shims@<span class="number">1</span>.<span class="number">5</span>.<span class="number">1</span>/dist/es-module-shims.js"</span> crossorigin=<span class="string">"anonymous"</span>&gt;&lt;/script&gt;
  
  &lt;script type=<span class="string">"module"</span>&gt;
    <span class="keyword">import</span> * <span class="keyword">as</span> lit <span class="keyword">from</span> <span class="string">"lit"</span>;
    <span class="keyword">import</span> * <span class="keyword">as</span> litHtml <span class="keyword">from</span> <span class="string">"lit/html.js"</span>;
<span class="comment">  
    // Write main module code here, or <span class="keyword">as</span> a separate file with a <span class="string">"src"</span> attribute on the module script.</span>
    console.log(lit, litHtml);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Saving the HTML template locally and serving over a local server provides a full native modules workflow for working with remote npm packages without needing any separate build steps.</p>
<p>The included <a href="https://github.com/guybedford/es-module-shims" target="_blank" rel="noopener">ES Module Shims polyfill</a> ensures the import maps still work in browsers without import maps support.</p>
<div class="nextprev"><a class="edit" target="_blank" href="https://github.com/jspm/jspm.org/blob/main/pages/getting-started.md" rel="noopener">Edit</a><div class="next"><a href="/faq">FAQ&nbsp;â–¶</a></div></div></div>
</div>


</body></html>